{"ast":null,"code":"var _jsxFileName = \"C:\\\\workspace\\\\webChat\\\\front\\\\src\\\\component\\\\chatSocketio.jsx\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Client } from '@stomp/stompjs';\nimport SockJS from 'sockjs-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatApp2 = () => {\n  _s();\n  const [msg, setMsg] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [chatt, setChatt] = useState([]);\n  const [chkLog, setChkLog] = useState(false);\n  const socketRef = useRef(null);\n  const msgBox = chatt.map((item, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: item.name === name ? \"me\" : \"other\",\n    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n      children: /*#__PURE__*/_jsxDEV(\"b\", {\n        children: item.sender\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 15,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 13\n    }, this), \" \", \"[\", item.date, \"]\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      children: item.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 13\n    }, this)]\n  }, idx, true, {\n    fileName: _jsxFileName,\n    lineNumber: 13,\n    columnNumber: 9\n  }, this));\n  useEffect(() => {\n    if (!socketRef.current) {\n      const socket = new SockJS('ws//localhost:8080/wschat');\n      const stompClient = new Client({\n        webSocketFactory: () => socket,\n        debug: function (str) {\n          console.log(str);\n        },\n        onConnect: function (frame) {\n          stompClient.subscribe('/roomname/public', function (message) {\n            const receivedMessage = JSON.parse(message.body);\n            setChatt(prevChatt => [...prevChatt, receivedMessage]);\n          });\n        }\n      });\n      stompClient.activate();\n      socketRef.current = stompClient;\n    }\n  }, []);\n  const send = useCallback(() => {\n    if (name === \"\") {\n      alert(\"이름을 입력하세요.\");\n      document.getElementById(\"name\").focus();\n      return;\n    }\n    if (msg !== \"\") {\n      const chat = {\n        sender: name,\n        type: \"CHAT\",\n        content: msg\n      };\n      if (!chkLog) {\n        // 첫 번째 메시지는 사용자가 서버에 추가되는 것을 나타냄\n        socketRef.current.publish({\n          destination: \"/message/addUser\",\n          body: JSON.stringify(chat)\n        });\n        setChkLog(true);\n      } else {\n        // 이후 메시지는 일반 채팅 메시지\n        socketRef.current.publish({\n          destination: \"/message/sendMessage\",\n          body: JSON.stringify(chat)\n        });\n      }\n    } else {\n      alert(\"메세지를 입력하세요.\");\n      document.getElementById(\"msg\").focus();\n    }\n    setMsg(\"\");\n  }, [msg, name, chkLog]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: msgBox\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      disabled: chkLog,\n      placeholder: \"\\uC774\\uB984\\uC744 \\uC785\\uB825\\uD558\\uC138\\uC694.\",\n      type: \"text\",\n      id: \"name\",\n      value: name,\n      onChange: event => setName(event.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        id: \"msg\",\n        value: msg,\n        onChange: event => setMsg(event.target.value),\n        onKeyDown: ev => {\n          if (ev.keyCode === 13) {\n            send();\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: send,\n        children: \"\\uC804\\uC1A1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 9\n  }, this);\n};\n_s(ChatApp2, \"Kc2WW5WaFnnlZN/qtVgP4XmnsY4=\");\n_c = ChatApp2;\nexport default ChatApp2;\nvar _c;\n$RefreshReg$(_c, \"ChatApp2\");","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useState","Client","SockJS","jsxDEV","_jsxDEV","ChatApp2","_s","msg","setMsg","name","setName","chatt","setChatt","chkLog","setChkLog","socketRef","msgBox","map","item","idx","className","children","sender","fileName","_jsxFileName","lineNumber","columnNumber","date","message","current","socket","stompClient","webSocketFactory","debug","str","console","log","onConnect","frame","subscribe","receivedMessage","JSON","parse","body","prevChatt","activate","send","alert","document","getElementById","focus","chat","type","content","publish","destination","stringify","disabled","placeholder","id","value","onChange","event","target","onKeyDown","ev","keyCode","onClick","_c","$RefreshReg$"],"sources":["C:/workspace/webChat/front/src/component/chatSocketio.jsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { Client } from '@stomp/stompjs';\r\nimport SockJS from 'sockjs-client';\r\n\r\nconst ChatApp2 = () => {\r\n    const [msg, setMsg] = useState(\"\");\r\n    const [name, setName] = useState(\"\");\r\n    const [chatt, setChatt] = useState([]);\r\n    const [chkLog, setChkLog] = useState(false);\r\n    const socketRef = useRef(null);\r\n\r\n    const msgBox = chatt.map((item, idx) => (\r\n        <div key={idx} className={item.name === name ? \"me\" : \"other\"}>\r\n            <span>\r\n                <b>{item.sender}</b>\r\n            </span>{\" \"}\r\n            [{item.date}]\r\n            <br />\r\n            <span>{item.message}</span>\r\n        </div>\r\n    ));\r\n\r\n    useEffect(() => {\r\n        if (!socketRef.current) {\r\n            const socket = new SockJS('ws//localhost:8080/wschat');\r\n            const stompClient = new Client({\r\n                webSocketFactory: () => socket,\r\n                debug: function (str) {\r\n                    console.log(str);\r\n                },\r\n                onConnect: function (frame) {\r\n                    stompClient.subscribe('/roomname/public', function (message) {\r\n                        const receivedMessage = JSON.parse(message.body);\r\n                        setChatt((prevChatt) => [...prevChatt, receivedMessage]);\r\n                    });\r\n                },\r\n            });\r\n\r\n            stompClient.activate();\r\n            socketRef.current = stompClient;\r\n        }\r\n    }, []);\r\n\r\n    const send = useCallback(() => {\r\n        if (name === \"\") {\r\n            alert(\"이름을 입력하세요.\");\r\n            document.getElementById(\"name\").focus();\r\n            return;\r\n        }\r\n        if (msg !== \"\") {\r\n            const chat = {\r\n                sender: name,\r\n                type: \"CHAT\",\r\n                content: msg,\r\n            };\r\n            if (!chkLog) {\r\n                // 첫 번째 메시지는 사용자가 서버에 추가되는 것을 나타냄\r\n                socketRef.current.publish({ destination: \"/message/addUser\", body: JSON.stringify(chat) });\r\n                setChkLog(true);\r\n            } else {\r\n                // 이후 메시지는 일반 채팅 메시지\r\n                socketRef.current.publish({ destination: \"/message/sendMessage\", body: JSON.stringify(chat) });\r\n            }\r\n        } else {\r\n            alert(\"메세지를 입력하세요.\");\r\n            document.getElementById(\"msg\").focus();\r\n        }\r\n        setMsg(\"\");\r\n    }, [msg, name, chkLog]);\r\n    \r\n\r\n    return (\r\n        <div>\r\n            <div>\r\n                {msgBox}\r\n            </div>\r\n            <input\r\n                disabled={chkLog}\r\n                placeholder=\"이름을 입력하세요.\"\r\n                type=\"text\"\r\n                id=\"name\"\r\n                value={name}\r\n                onChange={(event) => setName(event.target.value)}\r\n            />\r\n            <div>\r\n                <textarea\r\n                    id=\"msg\"\r\n                    value={msg}\r\n                    onChange={(event) => setMsg(event.target.value)}\r\n                    onKeyDown={(ev) => {\r\n                        if (ev.keyCode === 13) {\r\n                            send();\r\n                        }\r\n                    }}\r\n                ></textarea>\r\n                <button\r\n                    onClick={send}\r\n                >전송</button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ChatApp2;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}